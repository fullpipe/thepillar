<canvas #pillarCanvas></canvas>

@if (!running()) {
<div class="control">
  @if(loading()) {
  <div class="loading">
    <div class="progress">{{ loadProgress() }}%</div>
    <div class="bar" [style.width.%]="loadProgress()"></div>
  </div>
  } @else { @if(prerunning()) {
  <div class="play">
    <ng-icon name="heroEllipsisHorizontal" />
  </div>
  } @else {
  <button class="play shake-horizontal" (click)="run()">
    <ng-icon name="heroPlay" />
  </button>
  } }
</div>
} @if (running()) {
<div class="switch" [class.is_active]="isActive$ | async">
  <div class="gains">
    <table>
      @for (gain of gains; track $index; let idx = $index) {
      <tr>
        <td></td>
        <td>
          <input
            type="range"
            [name]="'gain' + idx"
            min="0"
            max="100"
            [(ngModel)]="gain"
          />
        </td>
      </tr>
      }

      <tr>
        <td>
          <ng-icon name="heroRadio" />
        </td>
        <td>
          <input
            type="range"
            [name]="'radio-gain'"
            min="0"
            max="100"
            [(ngModel)]="radioGain"
          />
        </td>
      </tr>

      <tr>
        <td colspan="2">
          <div class="toggles">
            @if (micAvailable()) {
            <button [class.inactive]="!micOn()" (click)="micOn.set(!micOn())">
              <ng-icon name="heroMicrophone" />
            </button>
            }

            <button (click)="mute()">
              <ng-icon name="heroSpeakerXMark" />
            </button>
          </div>
        </td>
      </tr>
    </table>
  </div>

  <div class="actions">
    <button (click)="roll()">
      <ng-icon name="heroArrowPathRoundedSquare" />
    </button>
  </div>
</div>
}
